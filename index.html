<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title></title>
  <link rel="stylesheet" href="css/style.css" media="screen" title="no title" charset="utf-8">
  <link href="https://fonts.googleapis.com/css?family=Lato:400" rel="stylesheet"> 
</head>
<body>
  <canvas id="inkCanvas" width="298" height="168"></canvas>
  <div class="nav">
    <div class="navWrap">
      <div class="leftNav">
        <div class="navItem">ABOUT</div>
        <div class="navItem">EVENTS</div>
        <div class="navItem">SPONSOR</div>
      </div>
      <div class="rightNav">
        <div class="navItem">CONTACT</div>
        <div class="navItem">ARCHIVE</div>
        <div class="navItem">REGISTER</div>
      </div>
    </div>
    <div class="logoNav">
      <img src="img/logo.svg" alt="">
    </div>

  </div>
  <div  class="scroll">
    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    width="100%" height="100%" viewBox="0 0 50 400" enable-background="new 0 0 50 400" xml:space="preserve">
    <g opacity="0.8">
      <ellipse fill="#FFFFFF" cx="25" cy="14.772" rx="5.46" ry="4.915"/>
      <ellipse fill="#FFFFFF" cx="25" cy="87.146" rx="5.46" ry="4.915"/>
      <ellipse fill="#FFFFFF" cx="25" cy="160.746" rx="5.46" ry="4.915"/>

      <ellipse opacity="0.7" fill="none" stroke="#FBB040" stroke-width="2.4533" stroke-miterlimit="10" cx="25" cy="160.746" rx="10.459" ry="9.413"/>
      <ellipse fill="#FFFFFF" cx="25" cy="234.347" rx="5.46" ry="4.914"/>
      <ellipse fill="#FFFFFF" cx="25" cy="310.4" rx="5.46" ry="4.914"/>
      <ellipse fill="#FFFFFF" cx="25" cy="385.228" rx="5.46" ry="4.913"/>
      <line fill="none" stroke="#FFFFFF" stroke-width="0.9301" stroke-miterlimit="10" x1="25" y1="14.772" x2="25" y2="87.944"/>
      <line fill="none" stroke="#FFFFFF" stroke-width="0.9301" stroke-miterlimit="10" x1="25" y1="87.146" x2="25" y2="160.317"/>
      <line fill="none" stroke="#FFFFFF" stroke-width="0.9301" stroke-miterlimit="10" x1="25" y1="160.746" x2="25" y2="233.918"/>
      <line fill="none" stroke="#FFFFFF" stroke-width="0.9301" stroke-miterlimit="10" x1="25" y1="234.347" x2="25" y2="307.519"/>
      <line fill="none" stroke="#FFFFFF" stroke-width="0.9301" stroke-miterlimit="10" x1="25" y1="309.174" x2="25" y2="382.345"/>
    </g>
  </svg>

</div>
<div class="ham" id="ham">
  <svg viewBox="0 0 800 800" class="hamb" id="hamb">
    <rect
    x="69.654"
    height="420.341"
    width="420.344"
    y="229.936"
    transform="matrix(0.7071 -0.7071 0.7071 0.7071 -82.9689 199.9064)"
    stroke-miterlimit="10"
    id="rect4"
    stroke-width="12.2727"
    stroke="#FFFFFF"
    fill="none"
    opacity="0.7" />
    <path
    d="M300,220 C300,220 520,220 540,220 C740,220 640,540 520,420 C440,340 300,200 300,200"
    id="top" />
    <path
    d="M300,320 L540,320"
    id="middle" />
    <path
    d="M300,210 C300,210 520,210 540,210 C740,210 640,530 520,410 C440,330 300,190 300,190"
    id="bottom"
    transform="translate(480, 320) scale(1, -1) translate(-480, -318) " />
  </svg>
</div>
<div class="side-nav" id="side-nav">
  <div class="logo"></div>
  <div class="storyType">
    <svg version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    width="400px" height="400px" viewBox="0 0 400 400" enable-background="new 0 0 400 400" >
    <g>
      <polygon opacity="0.4" fill="#FFFFFF" points="277.68,101.426 86.74,101.426 122.003,15.352 312.943,15.352  "/>
      <polygon opacity="0.4" fill="#FFFFFF" points="277.68,196.2 86.74,196.2 122.003,110.128 312.943,110.128  "/>
      <polygon opacity="0.4" fill="#FFFFFF" points="277.68,290.973 86.74,290.973 122.003,204.901 312.943,204.901  "/>
      <polygon opacity="0.4" fill="#FFFFFF" points="277.68,385.505 86.74,385.505 122.003,299.432 312.943,299.432  "/>
    </g>
  </svg>

</div>
<div class="bar"></div>

<div class="menuList">
  <ul>
    <li class="active">HOME</li>
    <li>ABOUT</li>
    <li>REGISTER</li>
    <li>EVENTS</li>
    <li>ARCHIVES</li>
    <li>SPONSORS</li>
    <li>CONTACTS</li>
  </ul>
</div>
<div class="sideBar"></div>

</div>
<div class="landing">
  <div class="banner-wrapper">
    <div class="bangrp1">
      <canvas id="ban1" class="banner b1" width="100" height="335"></canvas>
      <canvas id="ban2" class="banner b2" width="100" height="335"></canvas>
    </div>
    <div class="bangrp2">
      <canvas id="ban3" class="banner b3"  width="100" height="335"></canvas>
      <canvas id="ban4" class="banner b4"  width="100" height="335"></canvas>
    </div>
    <div class="bangrp3">
      <canvas id="ban5" class="banner b5"  width="100" height="335"></canvas>
      <canvas id="ban6" class="banner b6"  width="100" height="335"></canvas>
    </div>
  </div>
  <div class="fire-wrapper">
    <div class="firegrp1">
      <canvas id="fire1" class="fire f1"  width="100" height="150"></canvas>
      <canvas id="fire2" class="fire f2"  width="100" height="150"></canvas>
    </div>
    <div class="firegrp2">
      <canvas id="fire3" class="fire f3"  width="100" height="150"></canvas>
      <canvas id="fire4" class="fire f4"  width="100" height="150"></canvas>
    </div>
  </div>
</div>
<div class="lampglow">

</div>


<script src="js/jquery.min.js"></script>
<script src="js/jquery.ba-throttle-debounce.js"></script>
<script type="text/javascript">
  var canvas = document.querySelector("#inkCanvas");
  var context = canvas.getContext("2d");

  var bg = new Image();
  bg.src = "img/inkbg.jpg";
  var myImage = new Image();
  myImage.src = "img/mask.png";

  myImage.addEventListener("load", loadImage, false);

  function loadImage(e) {
    animate();
  }

  var shift = 0;
  var frameWidth = 298;
  var frameHeight = 168;
  var totalFrames = 40;
  var currentFrame = 0;
  var maxSpeed=3;
  var speedvar=0;

  function animate() {
    context.clearRect(0, 0, 298, 168);

  //draw each frame + place them in the middle
  context.drawImage(myImage, shift, 0, frameWidth, frameHeight, 0, 0, frameWidth, frameHeight);
  // context.globalCompositeOperation = "multiply";
  context.drawImage(bg, 0, 0, 1600,907,0,0,frameWidth,frameHeight);
  if (speedvar==maxSpeed){
    shift += frameWidth;
    speedvar=0;
  }
  /*
    Start at the beginning once you've reached the
    end of your sprite!
    */
    if (currentFrame != totalFrames*maxSpeed) {
      // shift = 0;
      // currentFrame = 0;
      requestAnimationFrame(animate);
      currentFrame++;
    }

    speedvar++;
    if (currentFrame == totalFrames*maxSpeed) {
      $('#inkCanvas').fadeOut();
    }
  }
  context.globalCompositeOperation = "xor";

  // Sprite Animation

// var i=0;

// function repeatOften() {
//   $('.b1').addClass('ban'+i);
//   if (i!=0)
//   $('.b1').removeClass('ban'+(i-1));
//   i++;
//   if (i==26) {
//     i=0;
//   $('.b1').removeClass('ban25');
//   }
//   setTimeout(function () {
//   requestAnimationFrame(repeatOften);
//   }, 2000/25);
// }

// requestAnimationFrame(repeatOften);

function sprite (canvasId, spriteimg, frameWidth, frameHeight, totalFrames, invspeed) {

  var canvas = document.getElementById(canvasId);
  var context = canvas.getContext("2d");

  var myImage = new Image();
  myImage.src = spriteimg;

  myImage.addEventListener("load", loadImage, false);

  function loadImage(e) {
    animate();
  }

  var shift = 0;
  var currentFrame = 0;
  var speedvar=0;

  function animate() {
    context.clearRect(0, 0, frameWidth, frameHeight);

    context.drawImage(myImage, shift, 0, frameWidth, frameHeight, 0, 0, frameWidth, frameHeight);
    if (speedvar==invspeed){
      shift += frameWidth;
      speedvar=0;
    }
    if (currentFrame == totalFrames*invspeed) {
      shift = 0;
      currentFrame = 0;
    }
    requestAnimationFrame(animate);
    currentFrame++;

    speedvar++;
  }
}

sprite('ban1', 'img/ban1.png', 100, 335, 25, 3);
sprite('ban2', 'img/ban2.png', 100, 335, 25, 3);
sprite('ban3', 'img/ban3.png', 100, 335, 25, 3);
sprite('ban4', 'img/ban4.png', 100, 335, 25, 3);
sprite('ban5', 'img/ban5.png', 100, 335, 25, 3);
sprite('ban6', 'img/ban6.png', 100, 335, 25, 3);
sprite('fire1', 'img/fire.png', 100, 150, 38, 3);
sprite('fire2', 'img/fire.png', 100, 150, 38, 3);
sprite('fire3', 'img/fire.png', 100, 150, 38, 3);
sprite('fire4', 'img/fire.png', 100, 150, 38, 3);





$(document).ready(function(){
  $('.paint').addClass('startAnim');
});

var checkScrollSpeed = (function(settings){
  settings = settings || {};

  var lastPos, newPos, timer, delta,
        delay = settings.delay || 50; // in "ms" (higher means lower fidelity )

        function clear() {
          lastPos = null;
          delta = 0;
        }

        clear();

        return function(){
          newPos = window.scrollY;
      if ( lastPos != null ){ // && newPos < maxScroll
        delta = newPos -  lastPos;
      }
      lastPos = newPos;
      clearTimeout(timer);
      timer = setTimeout(clear, delay);
      return delta;
    };
  })();

// // listen to "scroll" event
// window.onscroll = function(){
//    speed = checkScrollSpeed();
//    console.log(speed);
//  };
var time1,time2;
$(window).scroll(function(){
 speed = checkScrollSpeed();
 console.log(speed);
 if(Math.abs(speed)>50){
   $('.paint').addClass('startAnim');
   time1 = new Date().getTime();
 }
 else {
  time2 = new Date().getTime();
  if(time2-time1>1500){
   $('.paint').removeClass('startAnim');
 }
 $('.paint').addClass('midAnim');
}
});
$(window).scroll($.debounce( 250, true, function(){
 $('#blurImg').fadeIn();


} ) );
$(window).scroll($.debounce( 250, function(){
 $('#blurImg').fadeOut();

} ) );

var menu="off";
$('.ham').click(function(){
  if(menu=="off"){
    $("#side-nav").css("opacity","100");    
    $('.side-nav').css({
     transform:'translateX(0px)'
   });


    menu="on";
    var div = document.createElement('div');
    // div.textContent = "Sup, y'all?";
    div.setAttribute('class', 'newdiv');
    document.body.appendChild(div);
    $('.newdiv').css({
      position: 'absolute',
      top: '0',
      left: '195px',
      width: '100vw',
      height: '100vh'
    });
    $('.newdiv').click(function() {
      $('.side-nav').css({
       transform:'translateX(-190px)'
     });
      menu="off";
      $(".ham").toggleClass("cross");
      $(this).remove();
    });
  }
  else{
    $('.side-nav').css({
     transform:'translateX(-190px)'
   });
    setTimeout(function(){
      $("#side-nav").css("opacity","0");  
    },500);    
    menu="off";
    $('.newdiv').remove();
  }
});

$('.newdiv').click(function() {
  $('.side-nav').css({
   transform:'translateX(-190px)'
 });
  menu="off";
  $(".ham").toggleClass("cross");
  $(this).remove();
});



$(".ham").click(function() {
  return $(".ham").toggleClass("cross");
});

$('.menuList ul li').click(function() {
  $('.menuList ul .active').removeClass('active');
  $(this).addClass('active');
});

setInterval(function () {
  $('.lampglow').fadeOut(2000);
  setTimeout(function () {
   $('.lampglow').fadeIn(2000); 
 }, 1500);
}, 7000);


</script>
</body>
</html>
